<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <title>Trake</title>

<script id="snake-vertex-shader" type="x-shader/x-vertex">
    attribute vec2 vPosition;

    uniform mediump vec2 displacement;
    uniform mediump vec2 viewSize;
    uniform mediump float length;

    uniform lowp int orientation;
    void main() { 
        //Horizontal
        mediump vec2 pos = vPosition;
        
        if (orientation == 1){
            pos[0] *= length;
        }
        else{
            pos[1] *= length;
        }
        gl_Position = vec4(pos + displacement,0.0,1.0); 
    }
</script>
<script id="snake-fragment-shader" type="x-shader/x-fragment">
    
    uniform mediump vec2 end;
    uniform mediump vec2 viewSize;
    uniform mediump float width;


    uniform int offset;
    uniform lowp int orientation;

    void main() { 

        highp vec2 normalizedFragCoord = (gl_FragCoord.xy/viewSize) * 2.0 -1.0;
        highp vec2 dif = normalizedFragCoord - end;
        dif.x *= viewSize.x / viewSize.y;

        // //Horizontal
        if (orientation == 1){
            mediump float y = sin(dif.x * 80.0 + float(offset) / 8.0) * (width * 0.5 );
            if(y < dif.y - width || y> dif.y + width)
                discard;
        }
        else{
            mediump float x = sin(dif.y * 80.0 + float(offset) / 8.0) * (width * 0.5 * viewSize.x / viewSize.y );
            if(x < dif.x - width* viewSize.x / viewSize.y || x> dif.x + width* viewSize.x / viewSize.y)
                discard;
        }
        gl_FragColor = vec4(0.0,0.0,0.0,1.0); 
    }
    
</script>

<script id="rectangle-vertex-shader" type="x-shader/x-vertex">
    attribute vec2 vPosition;

    uniform mediump vec2 displacement;
    uniform mediump vec2 viewSize;
    uniform mediump float length;
    uniform mediump float width;

    uniform lowp int orientation;
    void main() { 
        //Horizontal
        mediump vec2 pos = vPosition;
        
        pos[0] *= width;
        pos[1] *= length;
        gl_Position = vec4(pos + displacement,0.0,1.0); 
    }
</script>

<script id="rectangle-fragment-shader" type="x-shader/x-fragment">
    
    uniform mediump vec2 viewSize;

    uniform lowp int orientation;

    void main() { 

        gl_FragColor = vec4(0.0,0.0,0.0,1.0); 
    }
    
</script>


<script type="text/javascript" src="Common/webgl-utils.js"></script>
<script type="text/javascript" src="Common/initShaders.js"></script>
<script type="text/javascript" src="Common/MV.js"></script>
<script type="text/javascript" src="globals.js"></script>
<script type="text/javascript" src="direction.js"></script>
<script type="text/javascript" src="physics/physics.js"></script>

<script type="text/javascript" src="render/rectangle.js"></script>
<script type="text/javascript" src="game_objects/rectangle_game_object.js"></script>

<script type="text/javascript" src="game_objects/snake/snake_head.js"></script>
<script type="text/javascript" src="game_objects/snake/snake_part.js"></script>
<script type="text/javascript" src="game_objects/snake/snake.js"></script>

<script type="text/javascript" src="game_objects/collectible/collectible.js"></script>
<script type="text/javascript" src="game_objects/collectible/collectibleFactory.js"></script>

<script type="text/javascript" src="trake.js"></script>

</head>

<body>
    <canvas id="gl-canvas" width="512" height="512">
        Oops ... your browser doesn't support the HTML5 canvas element
    </canvas>
</body>

</html>
