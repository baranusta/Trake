<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <title>Trake</title>

<script id="snake-vertex-shader" type="x-shader/x-vertex">
    attribute vec2 vPosition;

    uniform mediump vec2 displacement;
    uniform mediump vec2 viewSize;
    uniform mediump float length;
    uniform mediump float width;

    uniform lowp int orientation;
    void main() { 
        //Horizontal
        mediump vec2 pos = vPosition;
        
        if (orientation == 1){
            pos[0] *= length;
            pos[1] *= width * 2.0;
        }
        else{
            pos[0] *= width * 2.0;
            pos[1] *= length;
        }
        gl_Position = vec4(pos + displacement,0.0,1.0); 
    }
</script>
<script id="snake-fragment-shader" type="x-shader/x-fragment">
    
    uniform mediump vec2 end;
    uniform mediump vec2 viewSize;
    uniform mediump float width;


    uniform int offset;
    uniform lowp int orientation;

    void main() { 

        highp vec2 normalizedFragCoord = (gl_FragCoord.xy/viewSize) * 2.0 -1.0;
        highp vec2 dif = normalizedFragCoord - end;
        dif.x *= viewSize.x / viewSize.y;
        highp float c = 0.4;
        // //Horizontal
        if (orientation == 1 && abs(dif.x) > width * 2.0){
            mediump float y = sin(dif.x * 80.0 + float(offset) / 8.0) * width * 0.6;
            highp float dist = dif.y - y;
            if( abs(dist) > width)
                discard;
            else
                c = dist / width * 2.0;
        }
        else if(abs(dif.y) > width * 2.0 * viewSize.x / viewSize.y){
            mediump float x = sin(dif.y * 80.0 + float(offset) / 8.0) * (width * 0.6* viewSize.x / viewSize.y );
            highp float dist = dif.x - x;
            if( abs(dist) > width* viewSize.x / viewSize.y)
                discard;
            else
                c = dist / width;
        }
        gl_FragColor = vec4(0.0,c,0.0,1.0); 
    }
    
</script>

<script id="rectangle-vertex-shader" type="x-shader/x-vertex">
    attribute vec2 vPosition;

    uniform mediump vec2 displacement;
    uniform mediump vec2 viewSize;
    uniform mediump float length;
    uniform mediump float width;
    
    attribute vec2 uvTexture;
    varying mediump vec2 texCoord;

    uniform lowp int orientation;
    uniform sampler2D uSampler;

    void main() { 
        //Horizontal
        mediump vec2 pos = vPosition;
        
        pos[0] *= width;
        pos[1] *= length;
        texCoord = uvTexture;
        uSampler;
        gl_Position = vec4(pos + displacement,0.0,1.0); 
    }
</script>

<script id="rectangle-fragment-shader" type="x-shader/x-fragment">
    
    uniform sampler2D uSampler;
    uniform mediump vec2 viewSize;

    uniform lowp int orientation;
    varying mediump vec2 texCoord;

    void main() { 
        gl_FragColor = texture2D(uSampler, texCoord);
    }
    
</script>


<script type="text/javascript" src="Common/webgl-utils.js"></script>
<script type="text/javascript" src="Common/initShaders.js"></script>
<script type="text/javascript" src="Common/MV.js"></script>
<script type="text/javascript" src="globals.js"></script>
<script type="text/javascript" src="direction.js"></script>
<script type="text/javascript" src="physics/physics.js"></script>

<script type="text/javascript" src="render/rectangle.js"></script>
<script type="text/javascript" src="game_objects/rectangle_game_object.js"></script>

<script type="text/javascript" src="game_objects/snake/snake_head.js"></script>
<script type="text/javascript" src="game_objects/snake/snake_part.js"></script>
<script type="text/javascript" src="game_objects/snake/snake.js"></script>

<script type="text/javascript" src="game_objects/collectible/collectible.js"></script>
<script type="text/javascript" src="game_objects/collectible/collectibleFactory.js"></script>

<script type="text/javascript" src="trake.js"></script>

</head>

<body>
    <canvas id="gl-canvas" width="1028" height="512">
        Oops ... your browser doesn't support the HTML5 canvas element
    </canvas>
</body>

</html>
